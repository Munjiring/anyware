<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "mybatis-3-mapper.dtd">
<mapper namespace="scheduleMapper">

	<!-- 새 일정 등록 -->
	<insert id="scheduleModalSave" parameterType="ScheduleModalSave">
		insert 
		  into TB_M_SCHEDULE
			 (
			   schedule_no
			 , start_date
			 , end_date
			 , start_time
			 , end_time
			 , sc_title
			 , sc_content
			 , status
			 , write_date
			 , member_no
			 , calendar_no
			 , allday
		     ) 
        values
             (
			  seq_sno.nextval
			, #{startDate}
			, #{endDate}
			, #{startTime}
			, #{endTime}
			, #{scTitle}
			, #{scContent}
			, #{status}
			, #{writeDate}
			, #{loginUser}
			, #{calendarNo}
			, #{allday}
		    )
	</insert>
	
	<!-- 새 캘린더 추가 -->
	<insert id="calendarModalSave" parameterType="CalendarModalSave">
		insert 
	      into tb_category
	         (
			   calendar_no
			 , my_calendar
			 , sc_color
			 , member_no
		     ) 
		values 
		     (
			   seq_cno.nextval
			 , #{myCalendar}
			 , #{scColor}
			 , 1
			 )
	</insert>
	
	<resultMap id="calendars" type="CalendarList">
		<id column="CALENDAR_NO" property="calendarNo" />
		<result column="MY_CALENDAR" property="myCalendar" />
		<result column="SC_COLOR" property="scColor" />
		<result column="MEMBER_NO" property="memberNo" />
	</resultMap>
	
	<!-- 캘린더 목록 -->
	<select id="calendarList" resultMap="calendars">
		select 
		       calendar_no
		     , my_calendar
		     , sc_color
		     , member_no
		  From tb_category
		 where 1=1
		   and member_no = #{memberNo}
	</select>
	
	<!-- 내 캘린더 수정 화면 -->
	<select id="calendarModify" resultMap="calendars">
		select
			   calendar_no
			 , my_calendar
			 , sc_color
			 , member_no
		  from tb_category
		 where 1=1
		   and calendar_no = #{calendarNo}
		   and member_no = #{memberNo}
	</select>

	<!-- 내 캘린더 수정 -->
	<update id="updateCalendar">
		update tb_category
		   set
			   my_calendar = #{myCalendar},
			   sc_color = #{scColor}
		 where 1=1
		   and calendar_no = #{calendarNo}
		   and member_no = #{memberNo}
	</update>
	
</mapper>